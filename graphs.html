<!DOCTYPE html>

<head>
    <style>
        body {
            font-family: helvetica;
            font-size: 14px;
        }

        #cy {
            height: 100%;
            width: 90%;
            position: absolute;
        }

        h1 {
            opacity: 0.5;
            font-size: 1em;
        }

        button {
            margin-right: 10px;
        }
    </style>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>

    <!--polyfills are needed for this extension for old browsers like IE -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.5.7/shim.min.js"></script>
    <script src="https://unpkg.com/layout-base/layout-base.js"></script>
    <script src="https://unpkg.com/cose-base/cose-base.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/cytoscape-cose-bilkent@4.1.0/cytoscape-cose-bilkent.min.js"></script>
</head>

<body>
    <button id="randomize" type="button">Randomize</button>
    <button id="layoutButton" type="button">CoSE-Bilkent</button>
    <button id="save" class="button">save</button>
    <button id="reload" class="button">reload</button>
    <div id="cy"></div>

</body>

<script>


    document.addEventListener("DOMContentLoaded", function () {
        var cy = (window.cy = cytoscape({
            container: document.getElementById("cy"),

            ready: function () {
                this.nodes().forEach(function (node) {
                    let width = [40, 50, 60];
                    let size = width[Math.floor(Math.random() * 2)];
                    node.css("width", size);
                    node.css("height", size);
                });
                this.layout({
                    name: "cose-bilkent",
                    animationDuration: 1000
                }).run();
            },

            style: [{
                selector: "node",
                style: {
                    'content': 'data(id)',
                    'text-valign': 'top',
                    'text-halign': 'center',
                    'background-color': '#008080'
                }
            },

            {
                selector: ":parent",
                style: {
                    "background-opacity": 0.073,
                    'background-color': '#ad1a66'
                }
            },

            {
                selector: "edge",
                style: {
                    width: 3,
                    "line-color": "#ad1a66"
                }
            }
            ],

            elements: [{
                group: "nodes",
                data: {
                    id: "Wikimedia"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "UG-AL"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Wikidata",
                    parent: "Wikimedia"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "SQ.Wikipedia",
                    parent: "Wikimedia"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "OSGeo"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "FSFE"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "FLOSSK"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "UG-AL"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "IDM"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "WCUGA",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "#42"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "OSM-AL",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "PMPC",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "OSCAL",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "TDF"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "GNOME"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Crypto",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "WCUGA",
                    parent: "Members"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Infra",
                    parent: "Members"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Finances",
                    parent: "Members"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Contributors",
                    parent: "Members"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Wikimedia"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "WCUGA",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "Members",
                    parent: "OpenLabs"
                }
            },
            {
                group: "nodes",
                data: {
                    id: "OpenLabs"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e0",
                    source: "SQ.Wikipedia",
                    target: "UG-AL"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e2",
                    source: "OSCAL",
                    target: "GNOME"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e3",
                    source: "OSCAL",
                    target: "TDF"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e18",
                    source: "FSFE",
                    target: "PMPC"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e19",
                    source: "SQ.Wikipedia",
                    target: "Wikidata"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e22",
                    source: "OSGeo",
                    target: "FLOSSK"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e23",
                    source: "IDM",
                    target: "Crypto"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e24",
                    source: "OSGeo",
                    target: "OSM-AL"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e25",
                    source: "UG-AL",
                    target: "WCUGA"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e29",
                    source: "WCUGA",
                    target: "SQ.Wikipedia"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e32",
                    source: "#42",
                    target: "Members"
                }
            },
            {
                group: "edges",
                data: {
                    id: "e33",
                    source: "FLOSSK",
                    target: "Members"
                }
            },
            ],
        }));

        document.getElementById("layoutButton").addEventListener("click", function () {
            var layout = cy.layout({
                name: "cose-bilkent",
                animate: "end",
                animationEasing: "ease-out",
                animationDuration: 1000,
                randomize: true
            });

            layout.run();
        });
        document.getElementById("randomize").addEventListener("click", function () {
            var layout = cy.layout({
                name: "random",
                animate: true,
                animationDuration: 1000,
                animationEasing: "ease-out"
            });

            layout.run();
        });

        document.getElementById("save").addEventListener("click", function () {
            window.localStorage.setItem("elements", JSON.stringify(cy.json()));
        });

        document.getElementById("reload").addEventListener("click", function () {
            cy.elements().remove();
            cy.json({
                elements: JSON.parse(window.localStorage.getItem("elements")).elements
            }).layout({
                name: 'preset'
            }).run();
            cy.fit();
            cy.center();
        });
    });
</script>

</html>